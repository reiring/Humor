<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Toothless Letter</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<h1 class="maintext">Hodně štěstí na zkoušce!</h1>
<div class="scene">
    
    <div class="letter">
        <h1>I</h1>
        <p class="secret-text"></p>
    </div>

    <div class="toothless" id="toothless">

        <!-- ears BEHIND -->
        <div class="ears">
            <div class="ear left"></div>
            <div class="ear right"></div>
        </div>

        <!-- HEAD -->
         <!-- HEAD -->
          <!-- HEAD -->
        <div class="head">

            <!-- fins -->
            <div class="fin top left"></div>
            <div class="fin bottom left"></div>
            <div class="fin top right"></div>
            <div class="fin bottom right"></div>

            <div class="details">
                <div class="arc a1"></div>
                <div class="arc a2"></div>
                <div class="arc a3"></div>
                <div class="arc a4"></div>

            </div>
            <!-- eyes -->
            <div class="eye left">
                <div class="eye-shape"></div>


                <div class="pupil"></div>
            </div>

            <div class="eye right">
                <div class="eye-shape"></div>

                <div class="pupil"></div>
            </div>

        </div>
    </div>
</div>

<script src="script.js"></script>
</body>
</html>

<script>
const toothless = document.getElementById('toothless');
const pupils = document.querySelectorAll('.pupil');
const letter = document.querySelector('.letter h1');
const ears = document.querySelectorAll('.ear');

let lowered = false;
let eyeMode = 'mouse'; // mouse | random | lock
let randomTimer = null;

const MAX_EYE_MOVE = 10;
const isTouch = window.matchMedia('(pointer: coarse)').matches;

/* ---------------------------
   TOOTHLESS CLICK (MOVE + EYES)
---------------------------- */
toothless.addEventListener('click', () => {
    lowered = !lowered;
    toothless.classList.toggle('lowered', lowered);

    // always switch to random eyes on click
    stopRandomEyes();
    startRandomEyes();
});

/* ---------------------------
   DESKTOP EYE TRACKING
---------------------------- */
document.addEventListener('mousemove', e => {
    if (eyeMode !== 'mouse') return;

    pupils.forEach(pupil => {
        const rect = pupil.parentElement.getBoundingClientRect();
        const cx = rect.left + rect.width / 2;
        const cy = rect.top + rect.height / 2;

        const dx = e.clientX - cx;
        const dy = e.clientY - cy;

        const angle = Math.atan2(dy, dx);

        pupil.style.transform = `
            translate(${Math.cos(angle) * MAX_EYE_MOVE}px,
                      ${Math.sin(angle) * MAX_EYE_MOVE}px)
        `;
    });
});

/* ---------------------------
   PHONE: PAIRED RANDOM EYES
---------------------------- */

let eyeTarget = { x: 0, y: 0 };
let eyeCurrent = { x: 0, y: 0 };
let eyeAnimFrame = null;

function pickNewEyeTarget() {
    const angle = Math.random() * Math.PI * 2;
    const dist = 4 + Math.random() * 4;

    eyeTarget.x = Math.cos(angle) * dist;
    eyeTarget.y = Math.sin(angle) * dist;
}

function animateEyes() {
    if (eyeMode !== 'random') return;

    // smoothing factor (lower = slower, smoother)
    const SMOOTHNESS = 0.08;

    eyeCurrent.x += (eyeTarget.x - eyeCurrent.x) * SMOOTHNESS;
    eyeCurrent.y += (eyeTarget.y - eyeCurrent.y) * SMOOTHNESS;

    pupils.forEach(pupil => {
        pupil.style.transform =
            `translate(${eyeCurrent.x}px, ${eyeCurrent.y}px)`;
    });

    eyeAnimFrame = requestAnimationFrame(animateEyes);
}

function startRandomEyes() {
    eyeMode = 'random';

    pickNewEyeTarget();

    // pick a new target occasionally
    randomTimer = setInterval(pickNewEyeTarget, 1200);

    cancelAnimationFrame(eyeAnimFrame);
    animateEyes();
}

function stopRandomEyes() {
    clearInterval(randomTimer);
    randomTimer = null;

    cancelAnimationFrame(eyeAnimFrame);
    eyeAnimFrame = null;
}

/* ---------------------------
   EAR TWITCH (UNCHANGED)
---------------------------- */
function twitchEar() {
    const ear = ears[Math.floor(Math.random() * ears.length)];
    ear.classList.add('twitch');

    setTimeout(() => ear.classList.remove('twitch'), 400);

    const next = 3000 + Math.random() * 6000;
    setTimeout(twitchEar, next);
}
setTimeout(twitchEar, 2000);

/* ---------------------------
   HEAD TILT FOLLOW
---------------------------- */

/* ---------------------------
   INIT
---------------------------- */
if (isTouch) {
    startRandomEyes();
}
</script>
<script>
/* ---------------------------
   25-CLICK EASTER EGG
---------------------------- */
let clickCount = 0;
let textFilled = false;

const secretText = document.querySelector('.secret-text');

document.addEventListener('click', () => {
    if (textFilled) return;

    clickCount++;

    if (clickCount === 25) {
        secretText.textContent = 'Kéž bych ti mohl říct, jak moc mi na tobě zálěží';
        textFilled = true;
    }
});
</script>